<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administracyjny Trenera</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400&display=swap" rel="stylesheet">
    <style>
        body {
    font-family: 'Roboto', sans-serif;
    background-image: url('dall.png');
	 background-size: cover;
    margin: 0;
    padding: 20px;
}

.admin-panel {
    background-color: #fff;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    padding: 20px;
    margin: auto;
    width: 90%;
    max-width: 800px;
}

.section {
    margin-bottom: 30px;
}

h1 {
    text-align: center;
    color: #333;
}

h2 {
    border-bottom: 2px solid #6e8efb;
    color: #555;
    padding-bottom: 5px;
    margin-bottom: 20px;
}

.day-container {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    margin-bottom: 10px;
}

.day-container label {
    margin-right: 5px;
}

.hour-label {
    margin: 0 5px;
}

.hour-checkbox {
    margin-right: 2px;
}

.submit-btn {
    display: block;
    width: 100%;
    margin-top: 20px;
}
.day-availability {
    margin-bottom: 20px;
    padding: 10px;
    background-color: #f9f9f9;
    border-radius: 5px;
}

.hours-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 10px;
}

.toggle-day {
    background-color: #6e8efb;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    margin-bottom: 10px;
}

.toggle-day:hover {
    background-color: #5d7ce2;
}
#availability-wrapper {
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
}

.day-column {
    flex-basis: calc(100% / 11); /* dzieli na 7 równych kolumn */
    padding: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    border-radius: 5px;
    margin: 10px;
    background: #f9f9f9;
}

.day-column h3 {
    text-align: center;
    margin-bottom: 10px;
}

.day-column button {
    background-color: #6e8efb;
    color: white;
    border: none;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    display: block;
    width: 100%;
    margin-bottom: 10px;
}

.day-column button:hover {
    background-color: #5d7ce2;
}

.hour-list {
    text-align: center;
}

.hour-list label {
    display: block;
    margin-bottom: 5px;
}

.week-navigation {
    text-align: center;
    margin: 20px;
}

.week-navigation button {
    padding: 5px 15px;
    margin: 0 10px;
    /* Add more styles for buttons */
}

.date-display {
    font-size: 0.9em;
    color: #555;
    margin-bottom: 5px;
}


    </style>
</head>
<body>

<div id="adminPanel" class="admin-panel">
    <h1>Panel Administracyjny Trenera</h1>
    <section id="availabilityManager" class="section">
        
        <section id="availabilityManager" class="section">
    <h2>Zarządzanie Dostępnością</h2>
    <div class="separator"></div>
    <div id="dailyAvailability">
       
<!-- Navigation Buttons -->
<div class="week-navigation">
    <button id="prevWeek">Previous Week</button>
    <button id="nextWeek">Next Week</button>
</div>
	   
<div id="availability-wrapper">
    <!-- Przykład dla poniedziałku, powtórz strukturę dla każdego dnia tygodnia -->
    <div class="day-column">
	 <div class="date-display"></div>
        <h3>Pon</h3>
        <button type="button" class="toggle-day" data-day="Monday">Z/O</button>
        <div class="hour-list">
            <!-- Checkboxy dla godzin, powtórz dla każdej godziny -->
            <label><input type="checkbox" name="monday-hours" value="6:00"> 6:00</label>
            <label><input type="checkbox" name="monday-hours" value="7:00"> 7:00</label>
			<label><input type="checkbox" name="monday-hours" value="8:00"> 8:00</label>
			<label><input type="checkbox" name="monday-hours" value="9:00"> 9:00</label>
			<label><input type="checkbox" name="monday-hours" value="10:00"> 10:00</label>
			<label><input type="checkbox" name="monday-hours" value="11:00"> 11:00</label>
			<label><input type="checkbox" name="monday-hours" value="12:00"> 12:00</label>
			<label><input type="checkbox" name="monday-hours" value="13:00"> 13:00</label>
			<label><input type="checkbox" name="monday-hours" value="14:00"> 14:00</label>
			<label><input type="checkbox" name="monday-hours" value="15:00"> 15:00</label>
			<label><input type="checkbox" name="monday-hours" value="16:00"> 16:00</label>
			<label><input type="checkbox" name="monday-hours" value="17:00"> 17:00</label>
			<label><input type="checkbox" name="monday-hours" value="18:00"> 18:00</label>
			<label><input type="checkbox" name="monday-hours" value="19:00"> 19:00</label>
			<label><input type="checkbox" name="monday-hours" value="20:00"> 20:00</label>
			<label><input type="checkbox" name="monday-hours" value="21:00"> 21:00</label>
        </div>
    </div>
    <div class="day-column">
	<div class="date-display"></div>
        <h3>Wt</h3>
        <button type="button" class="toggle-day" data-day="Tuesday">Z/O</button>
        <div class="hour-list">
            <!-- Checkboxy dla godzin, powtórz dla każdej godziny -->
            <label><input type="checkbox" name="tuesday-hours" value="6:00"> 6:00</label>
            <label><input type="checkbox" name="tuesday-hours" value="7:00"> 7:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="8:00"> 8:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="9:00"> 9:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="10:00"> 10:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="11:00"> 11:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="12:00"> 12:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="13:00"> 13:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="14:00"> 14:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="15:00"> 15:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="16:00"> 16:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="17:00"> 17:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="18:00"> 18:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="19:00"> 19:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="20:00"> 20:00</label>
			<label><input type="checkbox" name="tuesday-hours" value="21:00"> 21:00</label>
        </div>
</div>
<div class="day-column">
<div class="date-display"></div>
        <h3>Śr</h3>
        <button type="button" class="toggle-day" data-day="Wednesday">Z/O</button>
        <div class="hour-list">
            <!-- Checkboxy dla godzin, powtórz dla każdej godziny -->
            <label><input type="checkbox" name="wednesday-hours" value="6:00"> 6:00</label>
            <label><input type="checkbox" name="wednesday-hours" value="7:00"> 7:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="8:00"> 8:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="9:00"> 9:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="10:00"> 10:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="11:00"> 11:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="12:00"> 12:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="13:00"> 13:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="14:00"> 14:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="15:00"> 15:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="16:00"> 16:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="17:00"> 17:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="18:00"> 18:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="19:00"> 19:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="20:00"> 20:00</label>
			<label><input type="checkbox" name="wednesday-hours" value="21:00"> 21:00</label>
        </div>
</div>
<div class="day-column">
<div class="date-display"></div>
        <h3>Czw</h3>
        <button type="button" class="toggle-day" data-day="Thursday">Z/O</button>
        <div class="hour-list">
            <!-- Checkboxy dla godzin, powtórz dla każdej godziny -->
            <label><input type="checkbox" name="thursday-hours" value="6:00"> 6:00</label>
            <label><input type="checkbox" name="thursday-hours" value="7:00"> 7:00</label>
			<label><input type="checkbox" name="thursday-hours" value="8:00"> 8:00</label>
			<label><input type="checkbox" name="thursday-hours" value="9:00"> 9:00</label>
			<label><input type="checkbox" name="thursday-hours" value="10:00"> 10:00</label>
			<label><input type="checkbox" name="thursday-hours" value="11:00"> 11:00</label>
			<label><input type="checkbox" name="thursday-hours" value="12:00"> 12:00</label>
			<label><input type="checkbox" name="thursday-hours" value="13:00"> 13:00</label>
			<label><input type="checkbox" name="thursday-hours" value="14:00"> 14:00</label>
			<label><input type="checkbox" name="thursday-hours" value="15:00"> 15:00</label>
			<label><input type="checkbox" name="thursday-hours" value="16:00"> 16:00</label>
			<label><input type="checkbox" name="thursday-hours" value="17:00"> 17:00</label>
			<label><input type="checkbox" name="thursday-hours" value="18:00"> 18:00</label>
			<label><input type="checkbox" name="thursday-hours" value="19:00"> 19:00</label>
			<label><input type="checkbox" name="thursday-hours" value="20:00"> 20:00</label>
			<label><input type="checkbox" name="thursday-hours" value="21:00"> 21:00</label>
        </div>
</div>
<div class="day-column">
<div class="date-display"></div>
        <h3>Pt</h3>
        <button type="button" class="toggle-day" data-day="Friday">Z/O</button>
        <div class="hour-list">
            <!-- Checkboxy dla godzin, powtórz dla każdej godziny -->
            <label><input type="checkbox" name="friday-hours" value="6:00"> 6:00</label>
            <label><input type="checkbox" name="friday-hours" value="7:00"> 7:00</label>
			<label><input type="checkbox" name="friday-hours" value="8:00"> 8:00</label>
			<label><input type="checkbox" name="friday-hours" value="9:00"> 9:00</label>
			<label><input type="checkbox" name="friday-hours" value="10:00"> 10:00</label>
			<label><input type="checkbox" name="friday-hours" value="11:00"> 11:00</label>
			<label><input type="checkbox" name="friday-hours" value="12:00"> 12:00</label>
			<label><input type="checkbox" name="friday-hours" value="13:00"> 13:00</label>
			<label><input type="checkbox" name="friday-hours" value="14:00"> 14:00</label>
			<label><input type="checkbox" name="friday-hours" value="15:00"> 15:00</label>
			<label><input type="checkbox" name="friday-hours" value="16:00"> 16:00</label>
			<label><input type="checkbox" name="friday-hours" value="17:00"> 17:00</label>
			<label><input type="checkbox" name="friday-hours" value="18:00"> 18:00</label>
			<label><input type="checkbox" name="friday-hours" value="19:00"> 19:00</label>
			<label><input type="checkbox" name="friday-hours" value="20:00"> 20:00</label>
			<label><input type="checkbox" name="friday-hours" value="21:00"> 21:00</label>
        </div>
</div>
<div class="day-column">
<div class="date-display"></div>
        <h3>Sb</h3>
        <button type="button" class="toggle-day" data-day="Saturday">Z/O</button>
        <div class="hour-list">
            <!-- Checkboxy dla godzin, powtórz dla każdej godziny -->
            <label><input type="checkbox" name="saturday-hours" value="6:00"> 6:00</label>
            <label><input type="checkbox" name="saturday-hours" value="7:00"> 7:00</label>
			<label><input type="checkbox" name="saturday-hours" value="8:00"> 8:00</label>
			<label><input type="checkbox" name="saturday-hours" value="9:00"> 9:00</label>
			<label><input type="checkbox" name="saturday-hours" value="10:00"> 10:00</label>
			<label><input type="checkbox" name="saturday-hours" value="11:00"> 11:00</label>
			<label><input type="checkbox" name="saturday-hours" value="12:00"> 12:00</label>
			<label><input type="checkbox" name="saturday-hours" value="13:00"> 13:00</label>
			<label><input type="checkbox" name="saturday-hours" value="14:00"> 14:00</label>
			<label><input type="checkbox" name="saturday-hours" value="15:00"> 15:00</label>
			<label><input type="checkbox" name="saturday-hours" value="16:00"> 16:00</label>
			<label><input type="checkbox" name="saturday-hours" value="17:00"> 17:00</label>
			<label><input type="checkbox" name="saturday-hours" value="18:00"> 18:00</label>
			<label><input type="checkbox" name="saturday-hours" value="19:00"> 19:00</label>
			<label><input type="checkbox" name="saturday-hours" value="20:00"> 20:00</label>
			<label><input type="checkbox" name="saturday-hours" value="21:00"> 21:00</label>
        </div>
</div>
<div class="day-column">
<div class="date-display"></div>
        <h3>Nd</h3>
        <button type="button" class="toggle-day" data-day="Sunday">Z/O</button>
        <div class="hour-list">
            <!-- Checkboxy dla godzin, powtórz dla każdej godziny -->
            <label><input type="checkbox" name="sunday-hours" value="6:00"> 6:00</label>
            <label><input type="checkbox" name="sunday-hours" value="7:00"> 7:00</label>
			<label><input type="checkbox" name="sunday-hours" value="8:00"> 8:00</label>
			<label><input type="checkbox" name="sunday-hours" value="9:00"> 9:00</label>
			<label><input type="checkbox" name="sunday-hours" value="10:00"> 10:00</label>
			<label><input type="checkbox" name="sunday-hours" value="11:00"> 11:00</label>
			<label><input type="checkbox" name="sunday-hours" value="12:00"> 12:00</label>
			<label><input type="checkbox" name="sunday-hours" value="13:00"> 13:00</label>
			<label><input type="checkbox" name="sunday-hours" value="14:00"> 14:00</label>
			<label><input type="checkbox" name="sunday-hours" value="15:00"> 15:00</label>
			<label><input type="checkbox" name="sunday-hours" value="16:00"> 16:00</label>
			<label><input type="checkbox" name="sunday-hours" value="17:00"> 17:00</label>
			<label><input type="checkbox" name="sunday-hours" value="18:00"> 18:00</label>
			<label><input type="checkbox" name="sunday-hours" value="19:00"> 19:00</label>
			<label><input type="checkbox" name="sunday-hours" value="20:00"> 20:00</label>
			<label><input type="checkbox" name="sunday-hours" value="21:00"> 21:00</label>
        </div>
</div>

    <button id="updateAvailability" class="submit-btn">Aktualizuj Dostępność</button>
</section>

    </section>

    <section id="bookingManager" class="section">
        <h2>Zarządzanie Rezerwacjami</h2>
        <!-- Tu będzie interfejs do zarządzania rezerwacjami -->
    </section>

    <section id="trainingHistory" class="section">
        <h2>Historia Treningów</h2>
        <!-- Tu będzie wyświetlana historia treningów -->
    </section>

    <section id="userManager" class="section">
        <h2>Zarządzanie Profilami Użytkowników</h2>
        <!-- Tu będzie interfejs do zarządzania profilami użytkowników -->
    </section>
</div>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
  import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";
  import { getAuth } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";

  // Your web app's Firebase configuration
  const firebaseConfig = {
      apiKey: "AIzaSyAHZ6gQdYUSPFGJfW4dd5QH5IuOMG9PDnY",
      authDomain: "genius-f6a78.firebaseapp.com",
      projectId: "genius-f6a78",
      storageBucket: "genius-f6a78.appspot.com",
      messagingSenderId: "4413237203",
      appId: "1:4413237203:web:8ce44809d0b3dd0147b126"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);

  let currentStartDate = calculateStartOfWeek(new Date());

  document.addEventListener('DOMContentLoaded', async function() {
    
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        const userAvailabilityRef = doc(db, 'trainerAvailability', user.uid);
        const docSnap = await getDoc(userAvailabilityRef);

        if (docSnap.exists()) {
          const data = docSnap.data().availability;
          Object.keys(data).forEach(day => {
            data[day].forEach(hour => {
              const checkbox = document.querySelector(`input[name="${day}-hours"][value="${hour}"]`);
              if (checkbox) {
                checkbox.checked = true;
              }
            });
          });
        }
      }
    });

    const updateAvailabilityBtn = document.getElementById('updateAvailability');
    updateAvailabilityBtn.addEventListener('click', async function() {
      const availability = {};
      const daysOfWeek = ['Poniedziałek', 'Wtorek', 'Środa', 'Czwartek', 'Piątek', 'Sobota', 'Niedziela'];
      daysOfWeek.forEach(day => {
        const dayLowerCase = day.charAt(0).toLowerCase() + day.slice(1);
        const checkboxes = document.querySelectorAll(`input[name="${dayLowerCase}-hours"]:checked`);
        const availableHours = Array.from(checkboxes).map(cb => cb.value);
        availability[dayLowerCase] = availableHours;
      });

      try {
        const user = auth.currentUser;
        if (user) {
          const userAvailabilityRef = doc(db, 'trainerAvailability', user.uid);
          await setDoc(userAvailabilityRef, { availability }, { merge: true });
          alert('Dostępność zaktualizowana!');
        } else {
          alert('Nie zalogowano użytkownika!');
        }
      } catch (error) {
        console.error("Error updating availability: ", error);
        alert('Błąd podczas aktualizacji dostępności: ' + error.message);
      }
    });

    updateWeekDays();
  });

  function calculateStartOfWeek(date) {
    const day = date.getDay();
    const diff = date.getDate() - day + (day === 0 ? -6 : 1);
    return new Date(date.setDate(diff));
  }

  function updateWeekDays() {
    Array.from(document.querySelectorAll('.day-column')).forEach((column, index) => {
      const dateElement = column.querySelector('.date-display');
      const date = new Date(currentStartDate.getTime());
      date.setDate(date.getDate() + index);
      dateElement.textContent = date.toLocaleDateString();
      column.dataset.date = date.toISOString().split('T')[0];
    });
  }

  document.getElementById('prevWeek').addEventListener('click', () => {
    currentStartDate.setDate(currentStartDate.getDate() - 7);
    updateWeekDays();
  });

  document.getElementById('nextWeek').addEventListener('click', () => {
    currentStartDate.setDate(currentStartDate.getDate() + 7);
    updateWeekDays();
  });
</script>



</body>
</html>
